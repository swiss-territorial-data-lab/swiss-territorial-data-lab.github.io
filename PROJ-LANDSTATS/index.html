
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.0, mkdocs-material-8.5.6">
    
    
      
        <title>Using spatio-temporal neighbor data information to detect changes in land use and land cover - Swiss Territorial Data Lab</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.20d9efc8.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#using-spatio-temporal-neighbor-data-information-to-detect-changes-in-land-use-and-land-cover" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Swiss Territorial Data Lab" class="md-header__button md-logo" aria-label="Swiss Territorial Data Lab" data-md-component="logo">
      
  <img src="../assets/logo-stdl-transparent.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Swiss Territorial Data Lab
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Using spatio-temporal neighbor data information to detect changes in land use and land cover
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/swiss-territorial-data-lab" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    STDL on Github
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Swiss Territorial Data Lab" class="md-nav__button md-logo" aria-label="Swiss Territorial Data Lab" data-md-component="logo">
      
  <img src="../assets/logo-stdl-transparent.svg" alt="logo">

    </a>
    Swiss Territorial Data Lab
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/swiss-territorial-data-lab" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    STDL on Github
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Homepage
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/swiss-territorial-data-lab" class="md-nav__link">
        GitHub
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-introduction" class="md-nav__link">
    1. Introduction
  </a>
  
    <nav class="md-nav" aria-label="1. Introduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-background" class="md-nav__link">
    1.1 Background
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-objectives" class="md-nav__link">
    1.2 Objectives
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-input-data" class="md-nav__link">
    1.3 Input data
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-exploratory-data-analysis" class="md-nav__link">
    2. Exploratory data analysis
  </a>
  
    <nav class="md-nav" aria-label="2. Exploratory data analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-distribution-statistics" class="md-nav__link">
    2.1 Distribution statistics
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-quantity-statistics" class="md-nav__link">
    2.2 Quantity statistics
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-probability-matrix" class="md-nav__link">
    2.3 Probability matrix
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-methods" class="md-nav__link">
    3. Methods
  </a>
  
    <nav class="md-nav" aria-label="3. Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-temporal-spatial-module" class="md-nav__link">
    3.1 Temporal-spatial module
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-change-detection" class="md-nav__link">
    3.2 Change detection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-performance-metric" class="md-nav__link">
    3.3 Performance metric
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-training-and-testing-plan" class="md-nav__link">
    3.4 Training and testing plan
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-experiments" class="md-nav__link">
    4. Experiments
  </a>
  
    <nav class="md-nav" aria-label="4. Experiments">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-temporal-spatial-module" class="md-nav__link">
    4.1 Temporal-spatial module
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-integration-module" class="md-nav__link">
    4.2 Integration module
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-conclusion-and-outlook" class="md-nav__link">
    5. Conclusion and outlook
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#appendix" class="md-nav__link">
    Appendix
  </a>
  
    <nav class="md-nav" aria-label="Appendix">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a1-classes-of-land-cover-and-land-use" class="md-nav__link">
    A1. Classes of land cover and land use
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a2-probability-analysis-of-different-periods" class="md-nav__link">
    A2. Probability analysis of different periods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a3-alternative-version-of-section-32" class="md-nav__link">
    A3 Alternative version of Section 3.2
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="using-spatio-temporal-neighbor-data-information-to-detect-changes-in-land-use-and-land-cover">Using spatio-temporal neighbor data information to detect changes in land use and land cover<a class="headerlink" href="#using-spatio-temporal-neighbor-data-information-to-detect-changes-in-land-use-and-land-cover" title="Permanent link">&para;</a></h1>
<p>Shanci Li (Uzufly) - Alessandro Cerioni (Canton of Geneva) - Clotilde Marmy (ExoLabs) - Roxane Pott (swisstopo)</p>
<p>Proposed by the Swiss Federal Statistical Office - PROJ-LANDSTATS <br/>
September 2022 to March 2023 - Published on April 2023</p>
<p>All scripts are available on <a href="https://github.com/swiss-territorial-data-lab/proj-landstats">GitHub</a>.</p>
<p><br/></p>
<p><strong>Abstract</strong>: <em>From 2020 on, the Swiss Federal Statistical Office started to update the land use/cover statistics over Switzerland for the fifth time. To help and lessen the heavy workload of the interpretation process, partially or fully automated approaches are being considered. The goal of this project was to evaluate the role of spatio-temporal neighbors in predicting class changes between two periods for each survey sample point.</em> </p>
<p><em>The methodolgy focused on change detection, by finding as many unchanged tiles as possible and miss as few changed tiles as possible. 
Logistic regression was used to assess the contribution of spatial and temporal neighbors to the change detection. While time deactivation and less-neighbors have a 0.2% decrease on the balanced accuracy, the space deactivation causes 1% decrease. Furthermore, XGBoost, random forest (RF), fully convolutional network (FCN) and recurrent convolutional neural network (RCNN) performance are compared by the means of a custom metric, established with the help of the interpretation team. For the spatial-temporal module, FCN outperforms all the models with a value of 0.259 for the custom metric, whereas the logistic regression indicates a custom metrics of 0.249.</em> </p>
<p><em>Then, FCN and RF are tested to combine the best performing model with the model trained by OFS on image data only. When using temporal-spatial neighors and image data as inputs, the final integration module achieves 0.438 in custom metric, against 0.374 when only the the image data is used.</em> </p>
<p><em>It was conclude that temporal-spatial neighbors showed that they could light the process of tile interpretation.</em>  </p>
<h2 id="1-introduction">1. Introduction<a class="headerlink" href="#1-introduction" title="Permanent link">&para;</a></h2>
<p>The introduction presents the background and the objectives of the projects, but also introduces the input data and its specific features.</p>
<h3 id="11-background">1.1 Background<a class="headerlink" href="#11-background" title="Permanent link">&para;</a></h3>
<p>Since 1979, the <a href="https://www.bfs.admin.ch/bfs/en/home.html">Swiss Federal Statistical Office (FSO)</a> provides detailed and accurate information on the state and evolution of the <a href="https://s.geo.admin.ch/9e0f4458f3">land use</a> and the <a href="https://s.geo.admin.ch/9e0f4555c1">land cover</a> in Switzerland. It is a crucial tool for long-term spatial observation. With these statistics, it is possible to determine whether and to what extent changes in land cover and land use are consistent with the goals of Swiss spatial development policies (<a href="https://www.bfs.admin.ch/bfs/fr/home/statistiques/espace-environnement/enquetes/area.html">FSO</a>).</p>
<p align="center">
<img src="./image/labelled_tiles.webp" width=75%/>
<br />
<i>Figure 1: Visualization of the land cover and land use classification.</i>
</p>

<p>Every few years, the FSO carries out a survey on aerial or satellite images all over Switzerland. A grid with sample points spaced 100 meters apart overlays the images, providing 4.1 million sample points on which the statistics are based. The classification of the hectare tile is assigned on the center dot, as shown in Figure 1. Currently, a time series of four surveys is accessible, based on aerial images captured in the following years:</p>
<ul>
<li>1979–1985 (1st survey, 1985)</li>
<li>1992–1997 (2nd survey, 1997)</li>
<li>2004–2009 (3rd survey, 2009)</li>
<li>2013–2018 (4th survey, 2018)</li>
</ul>
<p>The first two surveys of the land statistics in 1979 and 1992 were made by visual interpretation of aerial analogue photos using stereoscopes. Since the 2004 survey, the methodology was deeply renewed, in particular through the use of digital aerial photographs, which are observed stereoscopically on workstations using specific photogrammetry software<!-- and are geometrically referenced using nomenclature from the Federal Office of Topography (swisstopo)-->.</p>
<p>A new nomenclature (2004 NOAS04) has also been introduced in 2004 which systematically distinguishes 46 land use categories and 27 land cover categories. A numerical label from this catalogue is assigned to each point by a team of trained interpreters. The 1979 and 1992 surveys have been revised according to the nomenclature NOAS04, so that all readings (1979, 1992, 2004, 2013) are comparable. On <a href="https://www.bfs.admin.ch/bfs/en/home/services/geostat/swiss-federal-statistics-geodata/land-use-cover-suitability/swiss-land-use-statistics.html">this page</a> you will find the geodata of the Land Use Statistics at the hectare level since 1979, as well as documentation on the data and the methodology used to produce these data. Detailed information on basic categories and principal domains can be found in <a href="#a1-classes-of-land-cover-and-land-use">Appendix 1</a>.</p>
<h3 id="12-objectives">1.2 Objectives<a class="headerlink" href="#12-objectives" title="Permanent link">&para;</a></h3>
<p>It is known that manual interpretation work is time-consuming and expensive. However, in a <a href="https://www.bfs.admin.ch/bfs/fr/home/statistiques/espace-environnement/enquetes/area.assetdetail.5687737.html">feasibility study</a>, the machine learning technique showed great potential capacity to help speed up the interpretation, especially with deep learning algorithms. According to the study, 50% of the estimated interpretation workload could be saved.</p>
<p>Therefore, FSO is currently carrying out a project to assess the relevance of learning and mastering the use of artificial intelligence (AI) technologies to automate (even partially) the interpretation of aerial images for change detection and classification. The project is called <a href="https://www.experimental.bfs.admin.ch/expstat/en/home/projects/adele.html">Area Statistics Deep Learning</a> (ADELE).</p>
<p>FSO had already developed tools for change detection and multi-class classification using the image data. However, the current workflow does not exploit the spatial and temporal dependencies between different points in the surveys. </p>
<p>The aim of this project is therefore to evaluate the potential of spatial-temporal neighbors in predicting whether or not points in the land statistics will change class. The methodolgy will be focused on change detection, by finding as many unchanged tiles as possible (automatized capacity) and miss as few changed tiles as possible. The detailed objectives of this project are to: </p>
<ol>
<li>explore the internal transformation patterns of tile classification from a data analytics perspective</li>
<li>build a prototype that performs change detection for tiles in the next survey  </li>
<li>help the domain experts to integrate the prototype within the OFS workflow</li>
</ol>
<h3 id="13-input-data">1.3 Input data<a class="headerlink" href="#13-input-data" title="Permanent link">&para;</a></h3>
<p>The raw data delivered by the domain experts is a table with 4'163'496 records containing the interpretation results of both land cover and land use from survey 1 to survey 4. An example record is shown in Table 1 and gives following information:</p>
<ul>
<li>RELI: 8-digit number composed by the <em>EAST</em> hectare number concatenated with the <em>NORTH</em> hectare number</li>
<li>EAST: EAST coordinates (EPSG:2056)</li>
<li>NORTH: NORTH coordinates (EPSG:2056)</li>
<li>LUJ: Land Use label for survey J</li>
<li>LCJ: Land Cover label for survey J</li>
<li>training: value 0 or 1. A value of 1 means that the point can be included in the training or validation set </li>
</ul>
<p><center></p>
<p><i>Table 1: Example record of raw data delivered by the domain experts.</i></p>
<table>
<thead>
<tr>
<th>RELI</th>
<th>EAST</th>
<th>NORTH</th>
<th>LU4*</th>
<th>LC4</th>
<th>LU3</th>
<th>LC3</th>
<th>LU2</th>
<th>LC2</th>
<th>LU1</th>
<th>LC1</th>
<th>training</th>
</tr>
</thead>
<tbody>
<tr>
<td>74222228</td>
<td>2742200</td>
<td>1222800</td>
<td>242</td>
<td>21</td>
<td>242</td>
<td>21</td>
<td>242</td>
<td>21</td>
<td>242</td>
<td>21</td>
<td>0</td>
</tr>
<tr>
<td>75392541</td>
<td>2753900</td>
<td>1254100</td>
<td>301</td>
<td>41</td>
<td>301</td>
<td>41</td>
<td>301</td>
<td>41</td>
<td>301</td>
<td>41</td>
<td>0</td>
</tr>
<tr>
<td>73712628</td>
<td>2737100</td>
<td>1262800</td>
<td>223</td>
<td>46</td>
<td>223</td>
<td>46</td>
<td>223</td>
<td>46</td>
<td>223</td>
<td>46</td>
<td>0</td>
</tr>
</tbody>
</table>
<p></center></p>
<p><small>
*<em>The shortened LC1/LU1 to LC4/LU4 will be used to simplify the notation of Land Cover/Use of survey 1 to survey 4 in the following documentation.</em>
</small> </p>
<p>For machine learning, training data quality has strong influence on model performance. With the <em>training</em> label, domain experts from FSO selected data points that are more reliable and representative. These 348'474 tiles and their neighbors composed the training and testing dataset for machine learning methodology.</p>
<h2 id="2-exploratory-data-analysis">2. Exploratory data analysis<a class="headerlink" href="#2-exploratory-data-analysis" title="Permanent link">&para;</a></h2>
<p>As suggested by domain experts, exploratory data analysis (EDA) is of significance to understand the data statistics and find the potential internal patterns of class transformation. The EDA is implemented from three different perspectives: distribution, quantity and probability. With the combination of the three, we can find that there do exist certain trends in the transformation of both land cover and land use classes. </p>
<p>For the land cover, main findings are: </p>
<ul>
<li>distribution: most surface of Switzerland is covered by vegetation or forest, bare land and water areas take up a considerable portion as well, artificial areas take up a small portion of the land cover</li>
<li>probability: transformation between some classes had never happened during the past four decades,  all classes of land cover are most likely to keep their status rather than to change</li>
<li>
<p>quantity: there are some clear patterns in quantitative changes</p>
<ol>
<li><em>Open Forest</em> goes to <em>Closed Forest</em></li>
<li><em>Brush Meadows</em> go to <em>Shrubs</em></li>
<li><em>Garden Plants</em> go to <em>Grass and Herb Vegetation</em></li>
<li><em>Shrubs</em> go to <em>Closed Forest</em></li>
<li><em>Cluster of Tree</em> goes to <em>Grass and Herb Vegetation</em></li>
</ol>
</li>
</ul>
<p>For the land use, main findings are:</p>
<ul>
<li>distribution: agricultural and forest areas are the main land uses, unused area also stands out from others classes.</li>
<li>probability: transformation between some classes had never happened during the past four decades; on the contrary, construction site, non-exploited urban areas and forest areas tend to change to other classes rather than keep unchanged</li>
<li>quantity: the most transformations happened inside the superclasses of <em>Arable and Grassland</em> and of <em>Forest not Agricultural</em>. </li>
</ul>
<p>Readers particularly interested by the change detection methods can directly go to <a href="#3-methods">Section 3</a>; otherwise, readers are welcomed to read the illustrated and detailed EDA given hereafter.  </p>
<h3 id="21-distribution-statistics">2.1 Distribution statistics<a class="headerlink" href="#21-distribution-statistics" title="Permanent link">&para;</a></h3>
<p align="center">
<img src="./image/dist-lc.webp" alt="Land cover distribution plot"/>
<br />
<i>Figure 2: Land cover distribution plot.</i>
</p>

<p align="center">
<img src="./image/dist-lu.webp" alt="Land use classification labels"/>
<br />
<i>Figure 3: Land use distribution plot.</i>
</p>

<p>First, a glance at the overall distribution of land cover and land use is shown in Figure 2 and 3. The X-axis is the label of each class while the Y-axis is the number of tiles in the <em>Log</em> scale. The records of the four surveys are plotted in different colors chronologically. By observation, some trends can be found across the four surveys. </p>
<p>Artificial areas only take up a small portion of the land cover (labels between 10 to 20), while most surface of Switzerland is covered by vegetation or forest (20 - 50). Bare land (50 - 60) and water areas (60 - 70) take up a considerable portion as well. For land use, it is obvious that the agricultural (200 - 250) and forest (300 - 310) areas are the main components while the unused area (421) also stands out from others.</p>
<p>Most classes kept the same tendency during the past 40 years. There are 11 out of 27 land cover classes and 32 out of 46 land use classes which are continuously increasing or decreasing all the time. Especially for land use, compared with 10 classes rising with time, 22 classes dropping, which indicates that there is some transformation patterns that caused the leakage from some classes to those 10 classes. We will dive into these patterns in the following sections.</p>
<h3 id="22-quantity-statistics">2.2 Quantity statistics<a class="headerlink" href="#22-quantity-statistics" title="Permanent link">&para;</a></h3>
<p>The data are explored in a quantitative way by three means:</p>
<ol>
<li>visualization of transformations between 2 surveys</li>
<li>visualization of sequential transformation over time </li>
<li>identifying patterns and most occured transformations in different periods.</li>
</ol>
<h4 id="221-transformation-visualization">2.2.1 Transformation visualization<a class="headerlink" href="#221-transformation-visualization" title="Permanent link">&para;</a></h4>
<p align="center">
<iframe src="./image/html/LC1_LC4_700_500.html" width="700px" height="500px" frameborder="0" scrolling="no"> </iframe>
<br />
<i>Figure 4: Land cover transformation from 1985 to 2018.</i>
</p>

<p>The analysis of the transformation patterns in quantitative perspective has been implemented in the interactive visualization in Figure 4. The nodes of the same color belong to a common superclass (principle domain). The size of the node represents the number of tiles for the class and the width of the link reflects the number of transformations in log scale. When hanging over your mouse on these elements, detailed information such as the class label code and the number of transformations will be shown. Clicking the legend will enable you to select the superclasses in which the transformation should be analyzed.</p>
<p>Pre-processing had been done for the transformation data. To simplify the graph and stand out the major transformations, links with the number of transformations less than 0.1% of the total were removed from the graph. The filter avoids too many trivial links (580) connecting nearly all the nodes, leaving significant links (112) only. The process filtered 6.5% of the transformations in land cover and 11.5% in land use, which is acceptable considering it is a quantitative analysis focusing on the major transformation.</p>
<h4 id="222-sequential-transformation-visualization">2.2.2 Sequential transformation visualization<a class="headerlink" href="#222-sequential-transformation-visualization" title="Permanent link">&para;</a></h4>
<p align="center">
<img src="./image/sequential.gif" width=95%/>
<br />
<i>Figure 5: Land cover sequential transformation.</i>
</p>

<p>In addition to the transformation between the 2 surveys, the sequential transformation over time had also been visualized. Here, a similar filter is implemented as well to simplify the result and only tiles that had changed during the 4 surveys are visualized. In Figure 5, the box of a class in column 1985 (survey 1) is composed of different colors while the box of a class in column 2018 (survey 4) only has one color. This is caused by the color of the link showing a kind of sequential transformation. The different colors of a class in the first column show the end status (classification) of the tiles in survey 4.</p>
<p>There are some clear patterns we can find in the graph. For example, the red lines point out four diamond patterns in the graph. The diamond pattern with the edges in the same color illustrates the continuous trend that one class of tiles is transferred to the other class. In this figure, it is obvious that the <em>Tree Clusters</em> are degraded to the <em>Grass and Herb</em>, while <em>Grass and Herb</em> are transferred to the <em>Consolidated Surfaces</em>, showing the expansion of urban areas and the destruction to the natural environment.</p>
<h4 id="223-quantity-statistics-analysis">2.2.3 Quantity statistics analysis<a class="headerlink" href="#223-quantity-statistics-analysis" title="Permanent link">&para;</a></h4>
<p>Comparing the visualization of different periods, a constant pattern has been spotted in both land cover and land use. For example in land cover, the most transformation happened between the superclass of <em>Tree Vegetation</em> and <em>Brush Vegetation</em>. Also, a visible bi-direction transformation between <em>Grass and Herb Vegetation</em> and <em>Clusters of Trees</em> is witnessed. Greenhouses, wetlands and reedy marshes hardly have edges linked to them all over time, which illustrates that either they have a limited area or they hardly change. </p>
<p>A similar property can also be captured in land use classes. The most transformation happened inside the superclass of <em>Arable and Grassland</em> and <em>Forest not Agricultural</em>. Also, a visible transformation from <em>Unused</em> to <em>Forest</em> is highlighted by others.</p>
<p>Combining the findings above, it is clear that the transformation related to the <em>Forest</em> and <em>Vegetation</em> is the main part of the story. The forest shrinks or expands over time, changing to shrubs and getting back later. The <em>Arable and Grassland</em> keeps changing based on the need for agriculture or animal husbandry during the survey year. Different kinds of forests interconvert with each other which is a rational natural phenomenon. </p>
<h3 id="23-probability-matrix">2.3 Probability matrix<a class="headerlink" href="#23-probability-matrix" title="Permanent link">&para;</a></h3>
<p>The above analysis demonstrates the occurrence of transformation with quantitative statistics. However, the number of tiles for different classes is not a uniform distribution as shown in the distribution analysis. The largest class is thousands of times more than the smallest one. Sometimes, the quantity of a transformation is trivial compared with the majority, but it is caused by the small amount of tiles for the class. Even if the negligible class would not have a significant impact on the performance of change detection, it is of great importance to reveal the internal transformation pattern of the land statistics and support the multi-class classification task. Therefore, the probability analysis is designed as below:</p>
<p>The probability analysis for land cover/use contains 3 parts:</p>
<ol>
<li>The probability matrix presents the probability of transformation from the source class (Y-axis) to the destination class (X-axis). The value of the probability is illustrated by the depth of the color in the log scale.</li>
<li>The distribution of the probability that a class does not change, which is a more detailed visualization of the diagonal value of the probability matrix.</li>
<li>The distribution of the maximum probability that a class changes to another certain class. This is a deeper inspection to look for a fixed transformation pattern that exists between two classes.</li>
</ol>
<p>The probability is calculated by the status change between the beginning survey and the end survey stated in the figure title. For example Figure 6 is calculated by the transformation between survey 1 and survey 4, without taking into account possible intermediate changes in survey 2 and 3.  </p>
<h4 id="231-land-cover-analysis">2.3.1 Land cover analysis<a class="headerlink" href="#231-land-cover-analysis" title="Permanent link">&para;</a></h4>
<p align="center">
<img src="./image/LC_proba_matrix_example.webp" width=75%/>
<br />
<i>Figure 6: Land cover probability matrix from LC1 to LC4.</i>
</p>

<p>The first information that the matrix provides is the blank blocks with zero probability of conversion. This discloses that transformation between some classes had never happened during the past four decades. Besides, all the diagonal blocks are with distinct color depth, illustrating that all classes of land cover are most likely to keep their status rather than to change.</p>
<p>Another evident features of this matrix are the columns with destination classes <em>Grass and Herb Vegetation (21)</em> and <em>Closed Forest (41)</em>. There are a few classes such as <em>Shrubs (31)</em>, <em>Fruit Tree (33)</em>, <em>Garden Plants (35)</em> and <em>Open Forest (44)</em> which have a noticeable trend to convert to these two classes, which is partially consistent with the quantity analysis while revealing some new findings. </p>
<p align="center">
<img src="./image/LC_proba_not_change_example.webp" width=75%/>
<br />
<i>Figure 7: Land cover transformation probability without change.</i>
</p>

<p>When it comes to the refined visualization of the diagonal blocks, it is clear that half of the classes have more than an 80% probability of not transforming, while the minimum one only has about 35%. This is caused by the accumulation of the 4 surveys together which lasts 40 years. For a single decade, as the first 3 sub-graphs of Figure 23 in the <a href="#ap-fig4">Appendix A2.1</a>, the majority are over 90% probability and the minimum rises to 55%.</p>
<p align="center">
<img src="./image/LC_proba_change_example.webp" width=75%/>
<br />
<i>Figure 8: Maximum transformation probability to a certain class when land cover changes.</i>
</p>

<p>For those transformed tiles, the maximum probability of converting into another class is shown in Figure 8. This graph together with the matrix in Figure 6 can point out the internal transformation pattern. The top 5 possible transformations between the first survey and the forth survey are:</p>
<p><small></p>
<blockquote></blockquote>
<pre><code> 1. 38%      Open Forest (44)         --&gt;     Closed Forest (41)
 2. 36%      Brush Meadows (32)       --&gt;     Shrubs (31)
 3. 34%      Garden Plants (35)       --&gt;     Grass and Herb Vegetation (21)
 4. 29%      Shrubs (31)              --&gt;     Closed Forest (41)
 5. 26%      Cluster of Tree (47)     --&gt;     Grass and Herb Vegetation (21)
</code></pre>
<p></small></p>
<p>In this case, the accumulation takes effect as well. For a single decade, the maximum probability decreases to 25%, but the general distribution of the probability is consistent between the four surveys according to Figure 24 in the <a href="#ap-fig5">Appendix A2.1</a>.</p>
<h4 id="232-land-use-analysis">2.3.2 Land use analysis<a class="headerlink" href="#232-land-use-analysis" title="Permanent link">&para;</a></h4>
<figure>
<p align="center">
    <img src="./image/LU_proba_matrix_example.webp" width=75%/>
        <figcaption>Figure 9: Land use probability matrix from LU1 to LU4.</figcaption>
</figure>

<p>The land use probability matrix has different features compared with the land cover probability matrix. Although most diagonal blocks are with the deepest color depth, there are two areas highlighted by the red line presenting different statistics. The upper area is related to <em>Construction sites (146)</em> and <em>Unexploited Urban areas (147)</em>. These two classes tend to change to other classes rather than keep unchanged, which is reasonable since the construction time of buildings or infrastructures hardly exceeds 10 years. This is confirmed by the left side of the red-edged rectangular block, which has a deeper color depth. This illustrates that construction and unexploited areas ended in the <em>Settlement and Urban Areas</em> (superclass of 100 - 170).</p>
<p>The lower red area account for the pattern concerning the <em>Forest Areas (301 -304)</em>. The <em>Afforestation (302)</em>, <em>Lumbering areas (303)</em> and <em>Damaged Forest (304)</em> would thrive and recover between the surveys, and finally become <em>Forest (301)</em> again. </p>
<p align="center">
<img src="./image/LU_proba_not_change_example.webp" width=75%/>
<br />
<i>Figure 10: Land use transformation probability without change.</i>
</p>

<p>Figure 10 further validates the assumptions. With most classes with a high probability of not changing, there are two deep valleys for classes 144 to 147 and 302 to 304, which are exactly the results of the stories mentioned above. </p>
<p align="center">
<img src="./image/LU_proba_change_example.webp" width=75%/>
<br />
<i>Figure 11: Maximum transformation probability to a certain class when land use changes.</i>
</p>

<p>Figure 11 tells the difference in the diversity of transformation destination. The construction and unexploited areas would turn into all kinds of urban areas, with more than 95% changed and the maximum probability to a fixed class is less than 35%. While the <em>Afforestation</em>, <em>Lumbering areas</em> and <em>Damaged Forest</em> returned to <em>Forest</em> with a probability of more than 90%, the transformation pattern within these four classes is fairly fixed.</p>
<p>The distribution statistics, the quantity statistics and the probability matrices have shown to validate and complement each other during the exploratory analysis of the data.</p>
<h2 id="3-methods">3. Methods<a class="headerlink" href="#3-methods" title="Permanent link">&para;</a></h2>
<p>The developed method should be integrated in the OFS framework for change detection and classification of land use and land cover illustrated in Figure 12. The interesting parts for this project are highlighted in orange and will be presented in the following. </p>
<p align="center">
<img src="./image/frameworkOFS.jpg" alt="Workflow of FSO pipeline"/>
<br />
<i>Figure 12: Planned structure in FSO framework for final prediction.</i>
</p>

<p>Figure 12 shows on the left the input data type in the OFS framework. The current project work on the LC/LU neighbors introduced in <a href="#13-input-data">Section 1.3</a>. The main objective of the project - to detect change by means of these neighbors - is the temporal-spatial module in Figure 12. </p>
<p>As proposed by the feasibility study, FSO had implement studies on change detection and multi-class classification on swisstopo aerial images time series to accelerate the efficiency of the interpretation work. The predicted LC and LU probabilities and information obtained by deep learning are defined as the image-level module.</p>
<p>In a second stage of the project, the best model for combining the temporal-spatial and the image-level module outputs is explored to evaluate the gain in performance after integration of the spatial-temporal module in the OFS framework. This is the so-called integration module. The rest of the input data will not be part of the performance evaluation. </p>
<h3 id="31-temporal-spatial-module">3.1 Temporal-spatial module<a class="headerlink" href="#31-temporal-spatial-module" title="Permanent link">&para;</a></h3>
<p align="center">
<img src="./image/timespace.webp"/>
<br />
<i>Figure 13: Time and space structure of a tile and its neighbors.</i>
</p>

<p>The input data to the temporal-spatial module will be the historical interpretation results of the tile to predict and its 8 neighbors. The first three surveys are used as inputs to train the models while the forth survey serves as the ground truth of the prediction. This utilizes both the time and space information in the dataset like depicted in Figure 13.</p>
<p>During the preprocessing, the tiles with missing neighbors were discarded from the dataset to keep the data format consistent, which is insignificant (about 400 out of 348'868). The determination of change is influenced by both land cover and land use. When there is a disparity between the classifications in the fourth survey and the third one for a specific tile, it is identified as altered (positive) in change detection. The joint prediction of land cover and land use is based on the assumption that a correlation may exist between them. If the land cover of a tile undergoes a change, it is probable that its land use will also change.</p>
<p>Moreover, the tile is assigned numerical labels. Nevertheless, the model does not desire a numerical association between classes, even when they belong to the same superclass and are closely related. To address this, we employ one-hot encoding, which transforms a single land cover column into 26 columns, with all values set to '0' except for one column marked as '1' to indicate the class. Despite increasing the model's complexity with almost two thousand input columns, this is a necessary trade-off to eliminate the risk of numerical misinterpretation.</p>
<h3 id="32-change-detection">3.2 Change detection<a class="headerlink" href="#32-change-detection" title="Permanent link">&para;</a></h3>
<p>Usually, spatial change detection is a remote sensing application performed on aerial or satellite images for multiclass change detection. However, in this project, a table of point records is used for binary classification into <em>changed</em> and <em>not changed</em> classes. Different traditional and new deep learning approach have been explored to perform this task. The motivations to use them are given hereinafter. An extended version of this section with detailed introduction to the machine learning models is available in <a href="#a3-alternative-version-of-section-32">Appendix A3</a>.</p>
<p>Three traditional classification models, <em>logistic regression (LR)</em>, <em>XGBoost</em> and <em>random forest (RF)</em>, are tested. The three models represent the most popular approaches in the field - the linear, boosting, and bagging models.
In this project, logistic regression is well adapted because it can explain the relationship between one dependent binary variable and one or more nominal, ordinal, interval or ratio-level independent variables.
Concerning XGBoost, it has the advantage that weaker classifiers are introduced sequentially to focus on the areas where the current model is struggling, while misclassified observations would receive extra weight during training. 
Finally, in random forest, higher accuracy may be obtained and overfitting still avoided through the larger number of trees and the sampling process.</p>
<p>Beyond these traditional popular approaches, another two deep learning algorithms are explored as well: <em>fully connected network</em> and <em>convolutional recurrent neural network</em>. Different from the traditional machine learning algorithms, deep learning does not require manual feature extraction or engineering. Deep neural networks capture the desired feature with back-propagation optimization process. Besides, these deep neural networks have some special design for temporal or spatial inputs, because it is assumed that the internal pattern of the dataset would match with the network structure and the model will have better performance.</p>
<h4 id="321-focal-loss">3.2.1 Focal loss<a class="headerlink" href="#321-focal-loss" title="Permanent link">&para;</a></h4>
<p>Deep neural networks need differentiable loss function for optimization training. For this project with imbalanced classification task, the <em>local loss</em> was chosen rather than the traditional (binary) <em>cross entropy loss</em>. </p>
<div class="arithmatex">\[\begin{align}
\\
FL(p_t) = -{\alpha}(1-p_t)^{\gamma} \ log(p_t)
\\
\end{align}\]</div>
<p><small>
<em><em>where <span class="arithmatex">\(p_t\)</span> is the probability of predicting the correct class, <span class="arithmatex">\(\alpha\)</span> is a balance factor between positive and negative classes, and <span class="arithmatex">\(\gamma\)</span> is a modulation factor that controls how much weight is given to examples hard to classify.</em></em>
</small></p>
<p>Focal loss is a type of loss function that aims to solve the problem of class imbalance in tasks like classification. Focal loss modifies the cross entropy loss by adding a factor that reduces the loss for easy examples and increases the loss for examples hard to classify. This way, focal loss focuses more on learning from misclassified examples. Compared with other loss functions such as cross entropy, binary cross entropy and dice loss, some advantages of focal loss are:</p>
<ol>
<li>it can reduce the dominance of well-classified examples and prevent them from overwhelming the gradient</li>
<li>it can adaptively adjust the weight of each example based on its difficulty level</li>
<li>it can improve the accuracy and recall of rare classes by adjusting <span class="arithmatex">\(\alpha\)</span> to give more weight to them</li>
</ol>
<p><span class="arithmatex">\(\alpha\)</span> should be chosen based on the class frequency. A common choice is to set <span class="arithmatex">\(\alpha_t\)</span> is 1 minus the frequency of class t. This way, rare classes get more weight than frequent classes. <span class="arithmatex">\(\gamma\)</span> should be chosen based on how much you want to focus on hard samples. A larger gamma means more focus on hard samples, while a smaller gamma means less focus. The <a href="https://arxiv.org/pdf/1708.02002.pdf">original paper</a> suggested that a gamma equal to 2 is an effective value for most cases.</p>
<h4 id="322-fully-connected-network-fcn">3.2.2 Fully connected network (FCN)<a class="headerlink" href="#322-fully-connected-network-fcn" title="Permanent link">&para;</a></h4>
<p>Fully connected network (FCN) in deep learning is a type of neural network that consists of a series of fully connected layers. The major advantage of fully connected networks for this project is that they are structure agnostic. That is, no special assumptions need to be made about the input (for example, that the input consists of images or videos). </p>
<p>A disadvantage of FCN is that it can be very computationally expensive and prone to overfitting due to the large number of parameters involved. Another disadvantage is that it does not exploit any spatial or temporal structure in the input data, which can lead to poor performance for some tasks. </p>
<p>For implementation, the <a href="https://github.com/swiss-territorial-data-lab/proj-landstats/blob/66caf6f8864945a98007b8f2624c8202723817fe/scripts/utils.py#L46C1-L46C1">FCN</a> employ 4 hidden layers (2048, 2048, 1024, 512 neurons respectively) besides the input and output layer. Relu activation function are chosen before the output layer while sigmoid function is applied at the end to scale the result to probability representation.</p>
<h4 id="323-convolutional-recurrent-neural-network-convrnn">3.2.3 Convolutional recurrent neural network (ConvRNN)<a class="headerlink" href="#323-convolutional-recurrent-neural-network-convrnn" title="Permanent link">&para;</a></h4>
<p>Convolutional recurrent neural network (ConvRNN) is a type of neural network that combines convolutional neural networks (CNNs) and recurrent neural networks (RNNs). CNNs are good at extracting spatial features from images, while RNNs are good at capturing temporal features from sequences. ConvRNNs can be used for tasks that require both spatial and temporal features as it is meant to be achieved in this project. Furthermore, the historical data of the land cover and land use can be translated to some synthetic images. The synthetic images use channels to represent sequence of surveys and the pixel value represents ground truth label. Thus, the spatial relationship of the neighbour tiles could be extracted from the data structure with the CNN.</p>
<figure>
<p align="center">
    <img src="./image/ConvRNN-pipeline.webp" width=100%/>
        <figcaption>Figure 14: Convolutional Recurrent Neural Network Pipeline. </figcaption>
</figure>

<p>In this project, we explored ConvRNN with structure shown in Figure 14. The sequence of surveys are treated as sequence of input <span class="arithmatex">\(x^t\)</span>. With the recurrent structure and hidden states <span class="arithmatex">\(h^t\)</span> to transmit information, the temporal information could be extracted. Different from the traditional RNN, the function <span class="arithmatex">\(f\)</span> in hidden layers of the recurrent structure use <em>convolutional</em> operation instead of matrix computation and an additional CNN module is applied to the sequence output to detect the spatial information.  </p>
<h3 id="33-performance-metric">3.3 Performance metric<a class="headerlink" href="#33-performance-metric" title="Permanent link">&para;</a></h3>
<p>Once the different machine learning models are trained for the respective module, comparison has to be made on the test set to evaluate their performance. This will be performed with the help of metrics. </p>
<h4 id="331-traditional-metrics">3.3.1 Traditional metrics<a class="headerlink" href="#331-traditional-metrics" title="Permanent link">&para;</a></h4>
<p>As discovered in the <a href="#21-distribution-statistics">distribution analysis</a>, the dataset is strongly unbalanced. Some class is thousands of others. This is of importance to change detection. Moreover, among 348'474 tiles in the dataset, only 58'737 (16.86%) tiles have changed. If the overall accuracy is chosen as the performance metric, the biased distribution would make the model tend to predict everything unchanged. In that case, the accuracy of the model can achieve 83.1%, which is a quite high value achieved without any effort. Therefore, avoiding the problem during the model training and selecting the suitable metric that can represent the desired performance are the initial steps. </p>
<p>The constant model is defined as a model which predicts the third survey interpretation values as the prediction of the forth survey. In simple words, the constant model predicts that everything does not change. By this definition, we can calculate all kinds of metrics for other change detection models and compare them to the constant model metrics to indentify models with better performance.</p>
<p>For change detection with the constant model, the performance is as below:</p>
<p align="center">
<img src="./image/cofmat-constant-dist.webp" width=50%/>
<br />
<i>Figure 15: Confusion matrix of constant distribution as prediction: TP=True Positive, TN=True Negative, FP=False Positive, FN=False Negative.</i>
</p>

<p><center>
<i>Table 2: Metrics evaluation for constant model. </i>
</center></p>
<table>
<thead>
<tr>
<th>Models</th>
<th>Accuracy</th>
<th>Balanced Accuracy</th>
<th></th>
<th>Precision (PPV/NPV)</th>
<th>Recall (TPR/TNR)</th>
<th>F1-score</th>
</tr>
</thead>
<tbody>
<tr>
<td>Constant</td>
<td>0.831</td>
<td>0.500</td>
<td>Positive <br> Negative</td>
<td>0.000    <br> 0.831</td>
<td>0.000    <br> 1.000</td>
<td>0.000    <br> 0.907</td>
</tr>
</tbody>
</table>
<p><small></p>
<blockquote>
<p>Definition of abbreviations:</p>
</blockquote>
<pre><code>For positive case:

Precision = TP / (TP + FP)                   Recall = TP / (TP + FN)
(Positive predictive value, PPV)             (True positive rate, TPR)

For negative case:

Precision = TN / (TN + FN)                   Recall = TN / (TN + FP)   
(Negative predictive value, NPV)             (True negative rate, TNR)
</code></pre>
<ul>
<li>Detailed metrics definition can be found <a href="https://en.wikipedia.org/wiki/Positive_and_negative_predictive_values">here</a></li>
</ul>
<p></small></p>
<p>The aim of the change detection is to predict the tiles of high confidence that do not change, so that the interpretation from the last survey can be used directly. However, the negative-case-related metrics above and the accuracy are not suitable for the present task because of the imbalance nature of the problem. Indeed, they indicate a high performance for the constant model, which we know is not depicting the reality, because of the large amount of unchanged tiles. After the test, the balanced accuracy which is the mean of the true positive rate and the true negative rate is considered a suitable metric for change detection. </p>
<h4 id="332-specific-weighted-metric-for-change-detection">3.3.2 Specific weighted metric for change detection<a class="headerlink" href="#332-specific-weighted-metric-for-change-detection" title="Permanent link">&para;</a></h4>
<p>In theory, true negative rate is equivalent to 1 minus false positive rate. Optimizing balanced accuracy typically results in minimizing the false positive rate. However, our primary objective is to reduce false negative instances (i.e., changed cases labeled as unchanged), while maximizing the true positive rate and true negative rate. False positives are of lesser concern, as they will be manually identified in subsequent steps. Consequently, balanced accuracy does not adequately reflect the project's primary objective. With the help of FSO interpretation team, an additionnal, specific metric targeting on the objective has been designed to measure the model performance. Reminding the <a href="#2-exploratory-data-analysis">Exploratory Data Analysis</a>, some transformation patterns have been found and applied in this metric as well. </p>
<p align="center">
<img src="./image/metric-design-multi.webp" width=75%/>
<br />
<i>Figure 16: Workflow with multiple input to define a weighted metric.</i>
</p>

<p>As depicted in Figure 16, the FSO interpretation team designed two filters to derive a custom metric. The first filter combines inputs from all the possible modules (in this case, the image-level and temporal-spatial modules). The input modules give the probability of change detection or multi-class classification prediction with confidence. As prediction from  modules might be different, the first filter will set the final prediction of a tile as positive if any input module gives a positive prediction. Here the threshold to define positive is a significant hyperparameter to finetune. </p>
<p>The <em><strong>Weights Matrix</strong></em> defined by the human experts is the core of the entire metric. Based on professional experience and observation of EDA, the experts assigned different weights to all possible transformations. These weights demonstrate the importance of the transformation to the overall statistics. Besides, part of the labels is defined as <em><strong>Small Classes</strong></em>, which means that these classes are negligible or we do not consider them in this study. The second filter removes all the transformations related to the small classes and apply the weights matrix to all the remained tiles. Finally, the weighted metric is calculated as below:</p>
<div class="arithmatex">\[\begin{align}
Automatized \ Tiles &amp;= {\#Predicted \ Negatives} \\ \\
Automatized \ Capacity &amp;= {{\#Automatized \ Tiles} \over {\#Negatives \ (ground \ truth)}} \\ \\
Missed \ Weighted \ Changed \ Ratio &amp;= {{\sum \{Missed \ Change \times Weight\}} \over {\sum \{All \ Change \times Weight\}}} \\ \\
Weighted \ Metric &amp;= Automatized \ Capacity \times (0.1 - Missed \ Weighted \ Changed \ Ratio) \ / \ 0.1
\end{align}\]</div>
<p>From now on, we will still calculate metrics like balanced accuracy and recall for reference and analysis; however, the <em><strong>Weighted Metric</strong></em> is the decisive metric for model selection.</p>
<h3 id="34-training-and-testing-plan">3.4 Training and testing plan<a class="headerlink" href="#34-training-and-testing-plan" title="Permanent link">&para;</a></h3>
<p>Introduced in <a href="#13-input-data">Section 1.3</a>, the 348'474 tiles with temporal-spatial information are selected for training. The 80%-20% split is applied to the selected tiles to create the train set and the test set respectively. Adam optimizer and multi-step learning rate scheduler are deployed for better convergence.</p>
<p>For the temporal-spatial module, metrics for ablation study on the descriptors and descriptor importance are first computed. The descriptor importance is taken from XGBoost simulations. The ablation study is performed with the logistic regression and consists of training the model with:</p>
<ol>
<li>8 neighbors and time activated, "baseline"</li>
<li>4 neighbors (northern, western, southern, eastern neighbors) </li>
<li>no spatial-neighbors, "space deactivate"</li>
<li>no temporal-neighbors, "time deactivate"</li>
</ol>
<p>Then, the baseline configuration is used to trained the traditional algorithms and the deep learning ones. Metrics are compared and the best performing models are kept for the integration module. </p>
<p>Finally, the performance of several configurations are compared for the integration module. </p>
<ul>
<li>direct outputs of the image-level module</li>
<li>direct outputs of the best performing temporal-spatial module</li>
<li>outputs of the best performing temporal-spatial module, followed by RF training for the integration module. </li>
<li>outputs of the best performing temporal-spatial module, followed by FCN training for the integration module. </li>
</ul>
<p>The extra information gain from the temporal-spatial module will be studied by comparison with image-level performance only. The image-level data contain multi-class classification prediction and its confidence. We can calculate the change probability according to the probability of each class. Therefore, the weighted metric can also be applied at the image-level only. Then, the RF and FCN are tested for the integration module which combines various types of information sources. </p>
<h2 id="4-experiments">4. Experiments<a class="headerlink" href="#4-experiments" title="Permanent link">&para;</a></h2>
<p>The Experiments section covers the results obtained when performing the <a href="#34-training-and-testing-plan">planned simulations</a> for the temporal-spatial module and the integration module. </p>
<h3 id="41-temporal-spatial-module">4.1 Temporal-spatial module<a class="headerlink" href="#41-temporal-spatial-module" title="Permanent link">&para;</a></h3>
<h4 id="411-feature-engineering-time-and-space-deactivation">4.1.1 Feature engineering (time and space deactivation)<a class="headerlink" href="#411-feature-engineering-time-and-space-deactivation" title="Permanent link">&para;</a></h4>
<p>In the temporal-spatial module, the studied models take advantages of both the space (the neighbors) and the time (different surveys) information as introduced in <a href="#31-temporal-spatial-module">Section 3.1</a>. Ablation study is performed here to acknowledge the feature importance and which information really matters in the model.</p>
<p><center>
<i>Table 3: Model metrics for ablation plan.</i>
</center></p>
<table>
<thead>
<tr>
<th>Logistic Regression</th>
<th>Best threshold</th>
<th>Accuracy</th>
<th>Balanced Accuracy</th>
<th></th>
<th>Precision (PPV/NPV)</th>
<th>Recall (TPR/TNR)</th>
<th>F1-score</th>
</tr>
</thead>
<tbody>
<tr>
<td>Time deactivate</td>
<td>0.515</td>
<td>0.704</td>
<td>0.718</td>
<td>Positive Negative</td>
<td>0.330 <br> 0.930</td>
<td>0.740 <br> 0.696</td>
<td>0.457 <br> 0.796</td>
</tr>
<tr>
<td>Space deactivate</td>
<td>0.505</td>
<td>0.684</td>
<td>0.711</td>
<td>Positive Negative</td>
<td>0.316 <br> 0.930</td>
<td>0.752 <br> 0.670</td>
<td>0.445 <br> 0.779</td>
</tr>
<tr>
<td>4 neighbors</td>
<td>0.525</td>
<td>0.707</td>
<td>0.718</td>
<td>Positive Negative</td>
<td>0.332 <br> 0.929</td>
<td>0.734 <br> 0.701</td>
<td>0.458 <br> 0.799</td>
</tr>
<tr>
<td>Baseline*</td>
<td>0.525</td>
<td>0.711</td>
<td>0.720</td>
<td>Positive Negative</td>
<td>0.337 <br> 0.928</td>
<td>0.734 <br> 0.706</td>
<td>0.462 <br> 0.802</td>
</tr>
</tbody>
</table>
<p><small>
    <em>*Baseline: 8 neighbors with time and space activated</em>
</small></p>
<p><br>
Table 3 reveals the performance change when time or space information is totally or partially (4-neighbors instead of 8-neighbors) deactivated. While time deactivation and less-neighbors hardly have an influence on the balanced accuracy (only 0.2% decrease), the one for space deactivation decreased by about 1%. The result demonstrates that space information is more vital to the algorithm than time information, even though both have a minor impact.
<br></p>
<p align="center">
<img src="./image/neighbour-feat.webp" width=90%>
<br />
<i>Figure 17: Feature importance analysis comparasion of 4 (left) and 8 (right) neighbors.</i>
</p>

<p align="center" class='half'>
<img src="./image/time-deactivate-feat.webp" width=45%><img src="./image/space-deactivate-feat.webp" width=40%>
<br />
<i>Figure 18: Feature importance analysis comparasion of time (left) and space (right) deactivation.</i>
</p>

<p>Figure 17 and 18 give the feature importance analysis from the XGBoost model. The sum of feature importance from variables all related to the tile itself and its neighbors are plotted in the charts. The 4-neighbor and 8-neighbor have similar capacities but the importance of neighbors for the latter is much more than for the former. This is caused by the number of variables. With more neighbors, the number of variables related to the neighbor increases and the sum of the feature importance grows as well.</p>
<p>The feature importance illustrates the weight assigned to the input variables. From Figure 17, it is obvious that the variable related to the tile itself from past surveys is the most critical. Furthermore, the more recent, the more important. The neighbor on the east and west (neighbors 3 and 4) are more significant than others and even more than the land use of the tile in the first survey.</p>
<p>In conclusion, the feature importance is not evenly distributed. However, the ablation study shows that the model with all the features as input achieved the best performance.</p>
<h4 id="412-baseline-models-with-probability-or-tree-models">4.1.2 Baseline models with probability or tree models<a class="headerlink" href="#412-baseline-models-with-probability-or-tree-models" title="Permanent link">&para;</a></h4>
<p>Utilizing the time and space information from the neighbors, three baseline methods with probability or tree model are fine-tuned. The logistic regression outperforms the other two, achieving 72.0% balanced accuracy. As result, more than 41'000 tiles are correctly predicted as unchanged while only about 3'000 changed tiles are missed as they are the false negatives. Detailed metrics of each method are listed in Table 4. </p>
<p><br>
<center>
<i>Table 4: Performance metrics for traditional machine learning simulation of spatial-temporal model.</i>
</center></p>
<table>
<thead>
<tr>
<th>Models</th>
<th>Accuracy</th>
<th>Balanced Accuracy</th>
<th></th>
<th>Precision (PPV/NPV)</th>
<th>Recall (TPR/TNR)</th>
<th>F1-score</th>
</tr>
</thead>
<tbody>
<tr>
<td>Logistic Regression</td>
<td>0.711</td>
<td><strong>0.720</strong></td>
<td>Positive <br> Negative</td>
<td>0.337    <br> 0.928</td>
<td>0.734    <br> 0.706</td>
<td>0.462    <br> 0.802</td>
</tr>
<tr>
<td>Random Forest</td>
<td><strong>0.847</strong></td>
<td>0.715</td>
<td>Positive <br> Negative</td>
<td>0.775    <br> 0.849</td>
<td>0.134    <br> 0.992</td>
<td>0.229    <br> 0.915</td>
</tr>
<tr>
<td>XGBoost</td>
<td>0.837</td>
<td>0.715</td>
<td>Positive <br> Negative</td>
<td>0.533    <br> 0.869</td>
<td>0.297    <br> 0.947</td>
<td>0.381    <br> 0.906</td>
</tr>
<tr>
<td>Constant</td>
<td>0.830</td>
<td>0.500</td>
<td>Positive <br> Negative</td>
<td>0.000    <br> 0.830</td>
<td>0.000    <br> 1.000</td>
<td>0.000    <br> 0.907</td>
</tr>
</tbody>
</table>
<p align="center">
<img src="./image/metric_threshold.webp">
<br />
<i>

    21: Metric changes with different threshold for logistic regression.</i>
</p>

<p>Besides the optimal performance with balanced accuracy, logistic regression can manually adjust its ability by changing the decision threshold as its output is the probability to change instead of prediction only. For example, we can trade off between the true positive rate and the negative predictive value. As shown in Figure 19, if we decrease the threshold probability, the precision of the negative case (NPV) will increase while the true negative rate goes down. This means more tiles need manual checks; however, fewer changed tiles are missed. Considering both the performance and the characteristics, <strong>Logistic Regression</strong> is selected as the baseline model.</p>
<h4 id="413-neural-networks-fcn-and-convrnn">4.1.3 Neural networks: FCN and ConvRNN<a class="headerlink" href="#413-neural-networks-fcn-and-convrnn" title="Permanent link">&para;</a></h4>
<p>FCN and ConvRNN work differently: FCN does not have special structure designed for temporal-spatial data while ConvRNN has specific designation for time and space information respectively. To study these two extreme situations, we explored their performance and compared with the logistic regression which is the best of the baseline models. </p>
<p><center>
<i>Table 5: Performance metrics for deep machine learning simulation of spatial-temporal model</i>
</center></p>
<table>
<thead>
<tr>
<th>Models</th>
<th>Weighted Metric</th>
<th>Raw<br>Metric</th>
<th>Balanced Accuracy</th>
<th>Recall</th>
<th>Missed Changes</th>
<th>Missed<br>Changes<br>Ratio</th>
<th>Missed Weighted Changes</th>
<th>Missed Weighted Changes<br>Ratio</th>
<th>Automatized Points</th>
<th>Automatized Capacity</th>
</tr>
</thead>
<tbody>
<tr>
<td>LR (Macro)*</td>
<td>0.237</td>
<td>0.197</td>
<td>0.655</td>
<td>0.954</td>
<td>349</td>
<td>0.046</td>
<td>18995</td>
<td>0.035</td>
<td>14516</td>
<td>0.364</td>
</tr>
<tr>
<td>LR (BA)*</td>
<td><strong>0.249</strong></td>
<td>0.207</td>
<td>0.656</td>
<td>0.957</td>
<td>326</td>
<td>0.043</td>
<td>17028</td>
<td>0.031</td>
<td>14478</td>
<td>0.363</td>
</tr>
<tr>
<td>FCN</td>
<td><strong>0.259</strong></td>
<td>0.21</td>
<td>0.656</td>
<td>0.958</td>
<td>322</td>
<td>0.042</td>
<td>15563</td>
<td>0.029</td>
<td>14490</td>
<td>0.363</td>
</tr>
<tr>
<td>ConvRNN</td>
<td>0.176</td>
<td>0.133</td>
<td>0.606</td>
<td>0.949</td>
<td>388</td>
<td>0.051</td>
<td>19026</td>
<td>0.035</td>
<td>10838</td>
<td>0.272</td>
</tr>
<tr>
<td>Constant</td>
<td>-10.717</td>
<td>-10.72</td>
<td>0.500</td>
<td>0.000</td>
<td>7607</td>
<td>1.000</td>
<td>542455</td>
<td>1.00</td>
<td>47491</td>
<td>1.191</td>
</tr>
</tbody>
</table>
<p><small>
<em>*Macro: the model is trained with <a href="https://stephenallwright.com/micro-vs-macro-f1-score/">Macro F1-score</a>; BA: the model is trained with Balanced Accuracy.</em>
</small></p>
<p>As a result of its implementation (see <a href="#322-fully-connected-network-fcn">Section 3.2.2</a>), FCN outperforms all the models with a value of 0.259 for the weighted metric, slightly above the logistic regression with 0.249. ConvRNN does not perform well even if we have increased the size of hidden states to 1024. Following deliberation, we posit that the absence of one-hot encoding during the generation of synthetic images may be the cause, given that an increased number of channels could substantially explodes computational expenses. Since the ground truth label is directly applied to pixel values, the model may attempt to discern numerical relationships among distinct pixel values that, in reality, do not exist. This warrants further investigation in subsequent phases of our research.</p>
<h3 id="42-integration-module">4.2 Integration module<a class="headerlink" href="#42-integration-module" title="Permanent link">&para;</a></h3>
<p>Table 5 compares the performance of FCN or image-level only to several configurations for the integration module. </p>
<p><center>
<i>Table 5: Performance metrics for the integration model in combination with a spatial-temporal model.</i>
</center></p>
<table>
<thead>
<tr>
<th>Model</th>
<th>Weighted Metric</th>
<th>Raw<br>Metric</th>
<th>Balanced Accuracy</th>
<th>Recall</th>
<th>Missed Changes</th>
<th>Missed Changes<br>Ratio</th>
<th>Missed Weighted Changes</th>
<th>Missed Weighted Changes<br>Ratio</th>
<th>Automatized Points</th>
<th>Automatized Capacity</th>
</tr>
</thead>
<tbody>
<tr>
<td>FCN</td>
<td>0.259</td>
<td>0.210</td>
<td>0.656</td>
<td>0.958</td>
<td>322</td>
<td>0.042</td>
<td>15563</td>
<td>0.029</td>
<td>14490</td>
<td>0.363</td>
</tr>
<tr>
<td>image-level</td>
<td>0.374</td>
<td>0.305</td>
<td>0.737</td>
<td>0.958</td>
<td>323</td>
<td>0.042</td>
<td>15735</td>
<td>0.029</td>
<td>20895</td>
<td>0.524</td>
</tr>
<tr>
<td>LR + RF</td>
<td>0.434</td>
<td>0.372</td>
<td>0.752</td>
<td>0.969</td>
<td>241</td>
<td>0.031</td>
<td>10810</td>
<td>0.020</td>
<td>21567</td>
<td>0.541</td>
</tr>
<tr>
<td>FCN + RF</td>
<td><strong>0.438</strong></td>
<td>0.373</td>
<td>0.757</td>
<td>0.968</td>
<td>250</td>
<td>0.032</td>
<td>11277</td>
<td>0.021</td>
<td>22010</td>
<td>0.552</td>
</tr>
<tr>
<td>FCN + FCN</td>
<td><strong>0.438</strong></td>
<td>0.376</td>
<td>0.750</td>
<td>0.970</td>
<td>229</td>
<td>0.030</td>
<td>9902</td>
<td>0.018</td>
<td>21312</td>
<td>0.534</td>
</tr>
<tr>
<td>LR + FCN</td>
<td>0.423</td>
<td>0.354</td>
<td>0.745</td>
<td>0.967</td>
<td>255</td>
<td>0.033</td>
<td>10993</td>
<td>0.020</td>
<td>21074</td>
<td>0.528</td>
</tr>
</tbody>
</table>
<p>The study demonstrates that the image-level contains more information related to change detection compared with temporal-spatial neighbors (<em>FCN</em> row in the Table 5). However, performance improvement from the temporal-spatial module when combined with image-level data, achieving 0.438 in weighted metric in the end (<em>FCN+RF</em> and <em>FCN+FCN</em>).</p>
<p>Regarding the composition of different models for the two modules, FCN is proved to be the best one for the temporal-spatial module, while RF and FCN have similar performance in the integration module. The choice of integration module could be influenced by the data format of other potential modules. This will be further studied by the FSO team.</p>
<h2 id="5-conclusion-and-outlook">5. Conclusion and outlook<a class="headerlink" href="#5-conclusion-and-outlook" title="Permanent link">&para;</a></h2>
<p>This project studied the potential of historical and spatial neighbor data in change detection task for the fifth interpretation process of the areal statistic of FSO. For the evaluation of this specific project, a weighted metric was defined by the FSO team. The temporal-spatial information was proved not to be as powerful as image-level information which directly detects change within visual data. However, an efficient prototype was built with 6% performance improvement in weighted metric combining the temporal-spatial module and the image-level module. It is validated that integration of modules with different source information can help to enhance the final capacity of the entire workflow.</p>
<p>The next research step of the project would be to modify the current implementation of ConvRNN. If the numerical relationship is removed from the synthetic image data, ConvRNN should have similar performance as FCN theoretically. Also, CNN is worth trying to validate whether the temporal pattern matters in this dataset. Besides, by changing the size of the synthetic images, we can figure out how does the number of neighbour tiles impact the model performance.</p>
<!--## 6. Acknowledgements

We are very grateful to everyone who participated in this project and helped us achieve our goals. We thank the Swiss Federal Statistical Office for submitting this project to the STDL and for providing us with the necessary domain expertise to complete it. Special attention is given to the beneficiaries for their regular assistance and supervision. We congratulate Shanci Li (Uzufly for STDL) for his innovative ideas and technical realization of the project, and Clotilde Marmy (Exolabs for STDL) for her suggestions during the research process and for her review of the code and documentation. We also thank Alessandro Cerioni (State of Geneva for the STDL) for his wise technical advice and his thoroughness. Finally, we thank Roxane Pott (swisstopo for the STDL) for her leadership and project management, and Raphael Rollier (swisstopo for the STDL) for his coordination and general project communication.


-->

<h2 id="appendix">Appendix<a class="headerlink" href="#appendix" title="Permanent link">&para;</a></h2>
<h3 id="a1-classes-of-land-cover-and-land-use">A1. Classes of land cover and land use<a class="headerlink" href="#a1-classes-of-land-cover-and-land-use" title="Permanent link">&para;</a></h3>
<div id="ap-fig1" align="center">
<img src="./image/LC_table.svg" alt="Land cover classification labels"/>
<br />
<i>Figure 20: Land Cover classification labels.</i>
</div>

<div id="ap-fig2" align="center">
<img src="./image/LU_table.svg" alt="Land use classification labels"/>
<br />
<i>Figure 21: Land Use classification labels.</i>
</div>

<h3 id="a2-probability-analysis-of-different-periods">A2. Probability analysis of different periods<a class="headerlink" href="#a2-probability-analysis-of-different-periods" title="Permanent link">&para;</a></h3>
<h4 id="a21-land-cover">A2.1 Land cover<a class="headerlink" href="#a21-land-cover" title="Permanent link">&para;</a></h4>
<div id="ap-fig3" align="center">
<img src="./image/LC_proba_matrix.webp" alt="Land cover probability matrix"/>
<br />
<i>Figure 22: Land cover probability matrix.</i>
</div>

<div id="ap-fig4" align="center">
<img src="./image/LC_proba_not_change.webp"/>
<br />
<i>Figure 23: Land cover transformation probability without change.</i>
</div>

<div id="ap-fig5" align="center">
<img src="./image/LC_proba_change.webp"/>
<br />
<i>Figure 24: Maximum transformation probability to a certain class when land cover changes.</i>
</div>

<h4 id="a22-land-use">A2.2 Land use<a class="headerlink" href="#a22-land-use" title="Permanent link">&para;</a></h4>
<div id="ap-fig6" align="center">
<img src="./image/LU_proba_matrix.webp" />
<br />
<i>Figure 25: Land use probability matrix.</i>
</div>

<div id="ap-fig7" align="center">
<img src="./image/LU_proba_not_change.webp"/>
<br />
<i>Figure 26: Land use transformation probability without change.</i>
</div>

<div id="ap-fig8" align="center">
<img src="./image/LU_proba_change.webp"/>
<br />
<i>Figure 27: Maximum transformation probability to a certain class when land use changes.</i>
</div>

<h3 id="a3-alternative-version-of-section-32">A3 Alternative version of Section 3.2<a class="headerlink" href="#a3-alternative-version-of-section-32" title="Permanent link">&para;</a></h3>
<h4 id="a31-logistic-regression">A3.1 Logistic regression<a class="headerlink" href="#a31-logistic-regression" title="Permanent link">&para;</a></h4>
<p>Logistic regression is a kind of <em>Generalized Linear Model</em>. It is the appropriate regression analysis to conduct when the dependent variable is dichotomous (binary). Like all regression analyses, logistic regression is a predictive analysis in this project. Logistic regression is used to describe data and to explain the relationship between one dependent binary variable and one or more nominal, ordinal, interval or ratio-level independent variables.</p>
<h4 id="a32-xgboost-random-forest">A3.2 XGBoost &amp; random forest<a class="headerlink" href="#a32-xgboost-random-forest" title="Permanent link">&para;</a></h4>
<p align="center">
<img src="./image/xgboost_random.webp">
<br />
<i>Figure 28: Comparison of boosting and bagging models.</i>
</p>

<p>XGBoost and Random Forest both originate from the tree model, while one is the sequential variant and the other is the parallel variant. </p>
<p>Extreme Gradient Boosting (XGBoost) is a distributed, scalable gradient-boosted decision tree (GBDT) machine learning algorithm. Gradient boosting is a flexible method used for regression, multi-class classification, and other tasks since it is compatible with all kinds of loss functions. It recasts boosting as a numerical optimization problem with the goal of reducing the loss function of the model by adding weak classifiers while employing gradient descent. Later, a first-order iterative approach, gradient descent, is used to find the local optimal of its differentiable function. Weaker classifiers are introduced sequentially to focus on the areas where the current model is struggling while misclassified observations would receive extra weight during training. </p>
<p>Random Forest is a bagging technique that contains a number of decision trees generated from the dataset. Instead of relying solely on one decision tree, it takes the average of a number of trees to improve the predictive accuracy. For each tree, the input feature is a different sampled subset from all the features, making the model more robust and avoiding overfitting. Then, these trees are trained with a bootstrapping-sampled subset of the dataset respectively. Finally, the random forest takes the prediction from each tree and based on the majority votes makes the final decision. Higher accuracy is obtained and overfitting is avoided through the larger number of trees and the sampling process.</p>
<h4 id="a33-focal-loss">A3.3 Focal loss<a class="headerlink" href="#a33-focal-loss" title="Permanent link">&para;</a></h4>
<p>The next two methods are Deep Neural Networks which need differentiable loss function for optimization training. Here we first tell the difference between the loss function and evaluation metric.</p>
<p>The choice of loss function and evaluation metric depends on the task and data. The loss function should be chosen based on whether it is suitable for the model architecture and output type, while the evaluation metric should be relevant for the problem domain and application objectives.</p>
<p>The loss function and the evaluation metric are two different concepts in deep learning. The loss function is used to optimize the model parameters during training, while the evaluation metric is used to measure the performance of the model on a test set. The loss function and the evaluation metric may not be the same. For example, Here we use focal loss to train a classification model, but use balanced accuracy or specific defined metric to evaluate its performance. The reason for this is that some evaluation metrics may not be differentiable or easy to optimize, or they may not match with the objective of the model.</p>
<p>For this project with imbalanced classification task, we think the <strong>Focal Loss</strong> is a better choice than the traditional (binary) Cross Entropy Loss. </p>
<div class="arithmatex">\[\begin{align}
\\
FL(p_t) = -{\alpha}(1-p_t)^{\gamma} \ log(p_t)
\\
\end{align}\]</div>
<p><small>
<em><em>where p_t is the probability of predicting the correct class, <span class="arithmatex">\(\alpha\)</span> is a balance factor between positive and negative classes, and <span class="arithmatex">\(\gamma\)</span> is a modulation factor that controls how much weight is given to examples hard to classify.</em></em>
</small></p>
<p>Focal loss is a type of loss function that aims to solve the problem of class imbalance in tasks like classification. Focal loss modifies the cross entropy loss by adding a factor that reduces the loss for easy examples and increases the loss for examples hard to classify. This way, focal loss focuses more on learning from misclassified examples. Compared with other loss functions such as cross entropy, binary cross entropy and dice loss, some advantages of focal loss are:</p>
<ol>
<li>It can reduce the dominance of well-classified examples and prevent them from overwhelming the gradient.</li>
<li>It can adaptively adjust the weight of each example based on its difficulty level.</li>
<li>It can improve the accuracy and recall of rare classes by adjusting <span class="arithmatex">\(\alpha\)</span> to give more weight to them.</li>
</ol>
<p><span class="arithmatex">\(\alpha\)</span> should be chosen based on the class frequency. A common choice is to set <span class="arithmatex">\(\alpha_t\)</span> = 1 - frequency of class t. This way, rare classes get more weight than frequent classes. <span class="arithmatex">\(\gamma\)</span> should be chosen based on how much you want to focus on hard samples. A larger gamma means more focus on hard samples, while a smaller gamma means less focus. The <a href="https://arxiv.org/pdf/1708.02002.pdf">original paper</a> suggested gamma = 2 as an effective value for most cases.</p>
<h4 id="a34-fully-connected-network-fcn">A3.4 Fully connected network (FCN)<a class="headerlink" href="#a34-fully-connected-network-fcn" title="Permanent link">&para;</a></h4>
<figure>
<p align="center">
    <img src="./image/FCN.webp" width=75%/>
        <figcaption>Figure 29: Network structure of FCN.</figcaption>
</figure>

<p>The fully connected network (FCN) in deep learning is a type of neural network that consists of a series of fully connected layers. A fully connected layer is a function from <span class="arithmatex">\(\mathbb{R}_m\)</span> to <span class="arithmatex">\(\mathbb{R}_n\)</span> that maps each input dimension to each output dimension. The FCN can learn complex patterns and features from data using backpropagation algorithm.</p>
<p>The major advantage of fully connected networks is that they are “structure agnostic.” That is, no special assumptions need to be made about the input (for example, that the input consists of images or videos). Fully connected networks are used for thousands of applications, such as image recognition, natural language processing, and recommender systems. </p>
<p>A disadvantage of FCN is that it can be very computationally expensive and prone to overfitting due to the large number of parameters involved. Another disadvantage is that it does not exploit any spatial or temporal structure in the input data, which can lead to poor performance for some tasks. A possible alternative to fully connected network is convolutional neural network (CNN), which uses convolutional layers that apply filters to local regions of the input data, reducing the number of parameters and capturing spatial features. </p>
<h4 id="a35-convolutional-neural-network-cnn">A3.5 Convolutional neural network (CNN)<a class="headerlink" href="#a35-convolutional-neural-network-cnn" title="Permanent link">&para;</a></h4>
<p>CNN stands for convolutional neural network, which is a type of deep learning neural network designed for processing structured arrays of data such as images. CNNs are very good at detecting patterns in the input data, such as lines, shapes, colors, or even faces and objects. CNNs use a special technique called convolution, which is a mathematical operation that applies a filter (also called a kernel) to each part of the input data and produces an output called a feature map. Convolution helps to extract features from the input data and reduce its dimensionality.</p>
<p>CNNs usually have multiple layers of convolution, followed by other types of layers such as pooling (which reduces the size of the feature maps), activation (which adds non-linearity to the network), dropout (which prevents overfitting), and fully connected (which performs classification or regression tasks). CNNs can be trained using backpropagation and gradient descent algorithms.</p>
<p>CNNs are widely used in computer vision and have become the state of the art for many visual applications such as image classification, object detection, face recognition, semantic segmentation, etc. They have also been applied to other domains such as natural language processing for text analysis.</p>
<figure>
<p align="center">
    <img src="./image/CNN-pipeline.webp" width=75%/>
        <figcaption>Figure 30: Workflow of Convolutional Neural Network.</figcaption>
</figure>

<p>In this project, the historical data of the land cover and land use can be translated to some synthetic images. The synthetic images use channels to represent sequence of surveys and the pixel value represents ground truth label. Thus, the spatial relationship of the neighbour tiles could be extracted from the data structure with the CNN.</p>
<h4 id="a36-convolutional-recurrent-neural-network-convrnn">A3.6 Convolutional recurrent neural network (ConvRNN)<a class="headerlink" href="#a36-convolutional-recurrent-neural-network-convrnn" title="Permanent link">&para;</a></h4>
<p>A convolutional recurrent neural network (ConvRNN) is a type of neural network that combines convolutional neural networks (CNNs) and recurrent neural networks (RNNs). CNNs are good at extracting spatial features from images, while RNNs are good at capturing temporal features from sequences. ConvRNNs can be used for tasks that require both spatial and temporal features, such as image captioning and speech recognition.</p>
<p>A ConvRNN consists of two main parts: a CNN part and an RNN part. The CNN part takes an input image or signal and applies convolutional filters to extract features. The RNN part takes these features as a sequence and processes them with recurrent units that have memory. The output of the RNN part can be a single vector or a sequence of vectors, depending on the task. A ConvRNN can learn both spatial and temporal patterns from data that have both dimensions, such as audio signals or video frames. For example, a ConvRNN can detect multiple sound events from an audio signal by extracting frequency features with CNNs and capturing temporal dependencies with RNNs.</p>
<figure>
<p align="center">
    <img src="./image/ConvRNN-pipeline.webp" width=100%/>
        <figcaption>Figure 31: Convolutional Recurrent Neural Network Pipeline.</figcaption>
</figure>

<p>In this project, we explored ConvRNN with structure shown in Figure 31. The sequence of surveys are treated as sequence of input <span class="arithmatex">\(x^t\)</span>. With the recurrent structure and hidden states <span class="arithmatex">\(h^t\)</span> to transmit information, the temporal information could be extracted. Different from the traditional Recurrent Neural Network, the function <span class="arithmatex">\(f\)</span> in hidden layers of the recurrent structure use <strong>Convolutional</strong> operation instead of matrix computation and an additional CNN module is applied to the sequence output to detect the spatial information.  </p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2020-2021 Swiss Territorial Data Lab
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    <a href="https://github.com/swiss-territorial-data-lab" target="_blank" rel="noopener" title="Repo on Github" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    <a href="mailto:<info@stdl.ch>" target="_blank" rel="noopener" title="Send us an eMail!" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M498.1 5.6c10.1 7 15.4 19.1 13.5 31.2l-64 416c-1.5 9.7-7.4 18.2-16 23s-18.9 5.4-28 1.6l-126.3-52.5-40.1 74.5c-5.2 9.7-16.3 14.6-27 11.9S192 499 192 488v-96c0-5.3 1.8-10.5 5.1-14.7l165.3-212.6c2.5-7.1-6.5-14.3-13-8.4l-179 161.9-32 28.9c-9.2 8.3-22.3 10.6-33.8 5.8l-85-35.4C8.4 312.8.8 302.2.1 290s5.5-23.7 16.1-29.8l448-256c10.7-6.1 23.9-5.5 34 1.4z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.expand"], "search": "../assets/javascripts/workers/search.5bf1dace.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.078830c0.min.js"></script>
      
        <script src="../assets/javascripts/config.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>